@page "/yaml-to-json"
@using EOSC.Common.Services
@inject ApiCallService _apiCallService

<h3>Convert YAML to JSON</h3>

<div class="form-group">
    <label for="yamlInput">Enter YAML data:</label>
    <textarea class="form-control" id="yamlInput" rows="5" @bind="@yamlData"></textarea>
</div>

<button class="btn btn-primary" @onclick="ConvertToJSON">Convert</button>

@if (!string.IsNullOrEmpty(jsonData))
{
    <div class="mt-3">
        <h4>Converted JSON:</h4>
        <pre>@jsonData</pre>
    </div>
}

@code {
    private string yamlData = "";
    private string jsonData = "";

    private async Task ConvertToJSON()
    {
        // Remove unwanted characters from YAML data
        yamlData = yamlData.Replace("\"", "'");

        var request = new YamlToJsonRequest(yamlData);
        var response = 
        await _apiCallService.MakeApiCall<YamlToJsonRequest, YamlToJsonResponse>(
            "/api/YamlToJson", 
            request
        );

        if (response != null)
        {
            jsonData = response.JsonData;
        }
    }

    public class YamlToJsonRequest
    {
        public string YamlData { get; set; }

        public YamlToJsonRequest(string yamlData)
        {
            YamlData = yamlData;
        }
    }

    public class YamlToJsonResponse
    {
        public string JsonData { get; set; }
    }
}
